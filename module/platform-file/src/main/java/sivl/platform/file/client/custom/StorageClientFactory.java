package sivl.platform.file.client.custom;import java.io.IOException;import org.apache.commons.pool2.KeyedPooledObjectFactory;import org.apache.commons.pool2.PooledObject;import org.apache.commons.pool2.impl.DefaultPooledObject;import sivl.platform.file.client.FileClientConfig;/** * StorageClient工厂类 * 目的： * @author lixuefeng * @date 2016年1月7日 * @version 1.0 */public class StorageClientFactory implements KeyedPooledObjectFactory<String, StorageClient> {		private Integer connectTimeout = FileClientConfig.DEFAULT_CONNECT_TIMEOUT * 1000;	private Integer networkTimeout = FileClientConfig.DEFAULT_NETWORK_TIMEOUT * 1000;	public StorageClientFactory() {		super();	}	public StorageClientFactory(Integer connectTimeout, Integer networkTimeout) {		super();		this.connectTimeout = connectTimeout;		this.networkTimeout = networkTimeout;	}	@Override	public PooledObject<StorageClient> makeObject(String key) {		StorageClientImpl storageClient = new StorageClientImpl(key,connectTimeout,networkTimeout);		PooledObject<StorageClient> pooledStorageClient = new DefaultPooledObject<StorageClient>(storageClient);		return pooledStorageClient;	}	@Override	public void destroyObject(String key, PooledObject<StorageClient> pooledStorageClient) throws IOException {		StorageClient storageClient = pooledStorageClient.getObject();		storageClient.close();	}    @Override    public boolean validateObject(String key, PooledObject<StorageClient> p) {        StorageClient storageClient  = p.getObject();        if (storageClient.isClosed()) {            //return false to ignore this closed client            return false;        } else {            return true;        }    }	@Override	public void activateObject(String key, PooledObject<StorageClient> p)			throws Exception {			}	@Override	public void passivateObject(String key, PooledObject<StorageClient> p)			throws Exception {			}}