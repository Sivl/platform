package sivl.platform.file.client.custom;import java.io.IOException;import java.net.InetSocketAddress;import java.net.Socket;import java.util.List;import sivl.platform.file.client.FileClientConfig;import sivl.platform.file.cmd.CloseCmd;import sivl.platform.file.cmd.Command;import sivl.platform.file.cmd.GroupInfoCmd;import sivl.platform.file.cmd.QueryDownloadCmd;import sivl.platform.file.cmd.QueryUpdateCmd;import sivl.platform.file.cmd.QueryUploadCmd;import sivl.platform.file.cmd.StorageInfoCmd;import sivl.platform.file.model.FileGroupInfoModel;import sivl.platform.file.model.FileResultModel;import sivl.platform.file.model.FileStorageInfoModel;import sivl.platform.file.model.FileUploadStorageModel;public class TrackerClientImpl implements TrackerClient{		private Socket socket;	private String host;	private Integer port;	private Integer connectTimeout = FileClientConfig.DEFAULT_CONNECT_TIMEOUT * 1000;	private Integer networkTimeout = FileClientConfig.DEFAULT_NETWORK_TIMEOUT * 1000;		public TrackerClientImpl(String address){		super();		String[] hostport = address.split(":");		this.host = hostport[0];		this.port = Integer.valueOf(hostport[1]);	}		public TrackerClientImpl(String address,Integer connectTimeout, Integer networkTimeout){		this(address);		this.connectTimeout = connectTimeout;		this.networkTimeout = networkTimeout;	}		private Socket getSocket() throws IOException{		if(socket==null){			socket = new Socket();			socket.setSoTimeout(networkTimeout);			socket.connect(new InetSocketAddress(host, port),connectTimeout);		}		return socket;	}		@Override	public void close() throws IOException{		Socket socket = getSocket();		Command<Boolean> command = new CloseCmd();		command.exec(socket);		socket.close();		socket = null;	}	@Override	public FileResultModel<FileUploadStorageModel> getUploadStorage() throws IOException{		Socket socket = getSocket();		Command<FileUploadStorageModel> command = new QueryUploadCmd();		return command.exec(socket);	}		@Override	public FileResultModel<String> getUpdateStorageAddr(String group,String fileName) throws IOException{		Socket socket = getSocket();		Command<String> cmd = new QueryUpdateCmd(group,fileName);		return cmd.exec(socket);	}		@Override	public FileResultModel<String> getDownloadStorageAddr(String group,String fileName) throws IOException{		Socket socket = getSocket();		Command<String> cmd = new QueryDownloadCmd(group,fileName);		return cmd.exec(socket);	}		@Override	public FileResultModel<List<FileGroupInfoModel>> getGroupInfos() throws IOException{		Socket socket = getSocket();		Command<List<FileGroupInfoModel>> cmd = new GroupInfoCmd();		return cmd.exec(socket);	}		@Override	public FileResultModel<List<FileStorageInfoModel>> getStorageInfos(String group) throws IOException{		Socket socket = getSocket();		Command<List<FileStorageInfoModel>> cmd = new StorageInfoCmd(group);		return cmd.exec(socket);	}	}